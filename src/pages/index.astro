---
import { Squares } from "@/components/ui/squares-background";
import Layout from "../layouts/Layout.astro";
import { Button } from "@/components/ui/button";
import { Alert, AlertDescription } from "@/components/ui/alert";
import { Card } from "@/components/ui/card";
import { ChatConfigSchema } from "../schema/chat";
import {
  GitHubLogoIcon,
  CodeIcon,
  DownloadIcon,
  CheckIcon,
} from "@radix-ui/react-icons";
import FaqAccordion from "../components/FaqAccordion";

// Import license content
import License from "../../LICENSE?raw";

// GitHub repository details and stats
const GITHUB_REPO = "one-ie/one";
const GITHUB_URL = `https://github.com/${GITHUB_REPO}`;

// Fetch GitHub stats
const getGitHubStats = async () => {
  try {
    const response = await fetch(`https://api.github.com/repos/${GITHUB_REPO}`);
    const data = await response.json();
    return {
      stars: data.stargazers_count,
      forks: data.forks_count,
    };
  } catch (error) {
    console.error("Error fetching GitHub stats:", error);
    return { stars: "1", forks: "1" }; // Fallback values
  }
};

const stats = await getGitHubStats();

const SYSTEM_REQUIREMENTS = [
  "Node.js 18.x or higher",
  "pnpm package manager",
  "Modern web browser (Chrome, Firefox, Safari, Edge)",
  "Any modern operating system (Windows, macOS, Linux)",
  "Deploy on Vercel, Netlify, AWS or any Node.js server",
];

const INSTALLATION_STEPS = [
  {
    title: "Download the Source",
    description: "Download the ZIP file or clone the repository using Git",
  },
  {
    title: "Install Dependencies",
    description: "Run 'pnpm install' to install required packages",
  },
  {
    title: "Configuration",
    description: "Set up your environment variables following the .env.example",
  },
  {
    title: "Start Development",
    description: "Run 'pnpm dev' to start the development server",
  },
];

const faqs = [
  // Core Features
  {
    question: "What can I build with ONE?",
    answer:
      "ONE enables you to build complete AI-powered businesses. It's perfect for building 1) AI Sales Agents that engage customers and close deals 24/7 2) Multi-channel Content Generation for blogs, social media, and marketing 3) Full E-commerce with crypto and traditional payments 4) Courses and digital products.",
  },

  // Payments
  {
    question: "What payment methods are supported?",
    answer:
      "ONE makes it easy for you to accept all major payment methods through Stripe:\n‚Ä¢ Credit/Debit Cards (Visa, Mastercard, American Express)\n‚Ä¢ Digital Wallets (Apple Pay, Google Pay, Microsoft Pay)\n‚Ä¢ Bank Transfers (ACH, SEPA, BACS)\n‚Ä¢ Buy Now Pay Later (Klarna, Afterpay, Clearpay)\n‚Ä¢ Local Methods (iDEAL, Bancontact, giropay)\n‚Ä¢ International Cards (JCB, UnionPay)\n\nCrypto payments (BTC, ETH, SOL) are under active development - see progress at /crypto",
  },
  // AI Agents
  {
    question: "How powerful are the AI agents?",
    answer:
      "You can build enterprise-grade agents that can:\n‚Ä¢ Handle complete sales cycles\n‚Ä¢ Generate and optimize content\n‚Ä¢ Process transactions autonomously\n‚Ä¢ Learn from customer interactions\n‚Ä¢ Operate in multiple languages\n‚Ä¢ Integrate with external systems\n‚Ä¢ Maintain context across sessions",
  },
  // Content Generation
  {
    question: "What type of content can be automated?",
    answer:
      "The content automation system handles:\n‚Ä¢ Blog posts & articles\n‚Ä¢ Social media content\n‚Ä¢ Product descriptions\n‚Ä¢ Marketing materials\n‚Ä¢ Documentation & guides\n‚Ä¢ Email campaigns\n‚Ä¢ Video scripts & podcasts\n\nAll content is SEO-optimized and maintains your brand voice.",
  },
  // Technical
  {
    question: "What's the technical architecture?",
    answer:
      "ONE is built on modern technology:\n‚Ä¢ Astro & React for frontend\n‚Ä¢ Edge-optimized runtime\n‚Ä¢ Vercel AI SDK integration\n‚Ä¢ WebSocket for real-time features\n‚Ä¢ TypeScript support\n‚Ä¢ Shadcn/UI components\n‚Ä¢ API-first architecture",
  },
  // Getting Started
  {
    question: "How do I get started?",
    answer:
      "Getting started is straightforward:\n1. Download and install using pnpm\n2. Connect your AI provider (OpenAI, Anthropic, etc.)\n3. Set up payment processing\n4. Configure your first AI agent\n5. Deploy to your preferred platform\n\nVisit https://one.ie/docs/quickstart for step-by-step guidance.",
  },
  // Customization
  {
    question: "Can I customize everything?",
    answer:
      "Yes, ONE is fully customizable:\n‚Ä¢ Create custom AI agents\n‚Ä¢ Design unique workflows\n‚Ä¢ Build custom UI components\n‚Ä¢ Set up custom payment flows\n‚Ä¢ Define business rules\n‚Ä¢ Create specialized content templates\n‚Ä¢ Implement custom authentication",
  },
];

// You can override any default values here
const chatConfig = ChatConfigSchema.parse({
  provider: "mistral",
  model: "mistral-large-latest",
  systemPrompt: [
    {
      type: "text" as const,
      text: `You are ONE's lead AI advocate, helping users understand how to build AI-powered businesses with our framework. Your role is to guide visitors through our comprehensive platform that combines AI agents, crypto payments, and content automation.

Core Capabilities:
1. AI Agents & Automation
   ‚Ä¢ Autonomous sales agents 24/7
   ‚Ä¢ Content generation & optimization
   ‚Ä¢ Social media management
   ‚Ä¢ Customer interaction handling
   ‚Ä¢ Multi-language support
   ‚Ä¢ Context-aware responses
   ‚Ä¢ Custom training options

2. Payment Integration (via Stripe)
   ‚Ä¢ Credit/Debit Cards - All major networks
   ‚Ä¢ Digital Wallets - Apple/Google/Microsoft Pay
   ‚Ä¢ Bank Transfers - ACH/SEPA/BACS
   ‚Ä¢ Buy Now Pay Later - Multiple providers
   ‚Ä¢ Local Payment Methods - Regional options
   ‚Ä¢ International Cards - Global coverage
   ‚Ä¢ Real-time verification & processing
   ‚Ä¢ Note: Crypto payments in development (/crypto)

3. White-Label Options
   ‚Ä¢ $100 - Brand ONE as your own product
   ‚Ä¢ $1,000 - Sell unlimited white-labeled versions
   ‚Ä¢ Enterprise - Custom solutions available
   ‚Ä¢ Complete branding rights
   ‚Ä¢ Sell as your own product
   ‚Ä¢ No brand requirements

4. Content Automation
   ‚Ä¢ Blog post generation
   ‚Ä¢ Social media content
   ‚Ä¢ Product descriptions
   ‚Ä¢ Marketing materials
   ‚Ä¢ Documentation
   ‚Ä¢ Email campaigns
   ‚Ä¢ SEO optimization

Technical Foundation:
‚Ä¢ Modern Stack
  - Astro & React
  - Edge Runtime
  - TypeScript
  - Vercel AI SDK
  - WebSocket
  - Shadcn/UI
  - API-first

‚Ä¢ Enterprise Features
  - Custom AI training
  - Business logic integration
  - Workflow automation
  - Multi-channel deployment
  - Analytics & tracking
  - Security measures
  - Scalability options

Communication Style:
‚Ä¢ Be solution-focused
‚Ä¢ Highlight practical applications
‚Ä¢ Explain token benefits clearly
‚Ä¢ Share specific examples
‚Ä¢ Provide implementation steps
‚Ä¢ Address technical & business needs
‚Ä¢ Maintain professional enthusiasm

Key Points to Emphasize:
‚Ä¢ Complete business solution
‚Ä¢ Token-based white-labeling
‚Ä¢ Comprehensive payment options
‚Ä¢ AI agent capabilities
‚Ä¢ Content automation power
‚Ä¢ Easy implementation
‚Ä¢ Scalable architecture

Your goal is to help users understand how ONE can transform their business with AI agents, automated content, and integrated payments while explaining our token-based system for accessing premium features.`,
    },
  ],
  welcome: {
    message:
      "üëã Welcome! ONE is free software that lets you build intelligent AI agents and businesses without restrictions. Whether you're a CEO, engineer, educator or creator, you can create agents that build more agents. What would you like to explore?",
    avatar: "/icon.svg",
    suggestions: [
      {
        label: "ü§ñ Build AI Agents",
        prompt:
          "Tell me how I can create AI agents that build more agents",
      },
      {
        label: "üí° Free Forever",
        prompt: "What can I build with ONE? It's free forever!",
      },
      {
        label: "üîß Implementation",
        prompt: "How do I implement ONE in my project or business?",
      },
      {
        label: "üéì Learning & Education",
        prompt: "How can educators and students use ONE?",
      },
      {
        label: "üöÄ Quick Start",
        prompt: "Show me how to deploy my first AI agent",
      },
      {
        label: "üåê Community",
        prompt: "How can I connect with other ONE builders?",
      },
    ],
  },
});  

// Set the desired right panel mode
const rightPanelMode = "half"; // You can change this to 'full', 'half', 'floating', or 'icon'
---

<Layout
  title="ONE - AI Agents & Crypto Commerce Framework"
  chatConfig={chatConfig}
  rightPanelMode={rightPanelMode}
>
  <section class="relative pb-8 pt-6 md:pb-12 md:pt-10 lg:py-32 bg-neutral-900 overflow-hidden border-b border-neutral-800">
    <div class="absolute inset-0">
      <Squares client:load direction="diagonal" speed={0.5} squareSize={40} borderColor="#404040" hoverFillColor="#333" />
    </div>
    <div class="relative z-10 max-w-[64rem] flex flex-col items-center gap-8 text-center mx-auto px-4">
      <h1 class="text-5xl sm:text-7xl md:text-8xl font-bold tracking-tight text-neutral-100">
        Build{" "}
        <span class="text-blue-500">AI-Powered</span>{" "}
        <span class="text-neutral-100">Businesses</span>
      </h1>
      <div class="flex flex-col items-center gap-6 max-w-[800px]">
        <p class="text-lg sm:text-xl md:text-2xl text-neutral-400 leading-relaxed tracking-wide max-w-2xl">
          Create intelligent businesses with AI agents, automated content, websites, and
  accept payments. Free forever, open-source, and enterprise-ready.
        </p>

       </div>
    </div>  
  </section>

  <!-- Download Options Grid -->
  <section class="container mx-auto px-6 py-20 ">
    <h2 class="text-3xl font-bold text-center mb-12">Download & Get Started</h2>
    <div class="grid md:grid-cols-2 gap-8 w-full max-w-4xl mx-auto mb-12">
      <!-- Direct Download Card -->
      <Card
        className="p-6 flex flex-col items-center hover:shadow-lg transition-shadow"
      >
        <h3 class="text-2xl font-bold mb-4">Quick Download</h3>
        <p class="text-muted-foreground mb-6">
          Download the latest stable release directly
        </p>
        <a
          href={`https://github.com/one-ie/one/archive/refs/heads/main.zip`}
          class="w-full"
        >
          <Button size="lg" className="w-full">
            <DownloadIcon className="mr-2 h-5 w-5" />
            Download ZIP
          </Button>
        </a>
      </Card>

      <!-- Git Clone Card -->
      <Card
        className="p-6 flex flex-col items-center hover:shadow-lg transition-shadow"
      >
        <h3 class="text-2xl font-bold mb-4">Git Clone</h3>
        <p class="text-muted-foreground mb-6">Clone the repository using Git</p>
        <Button
          variant="outline"
          size="lg"
          className="w-full group bg-background border-2 hover:border-primary hover:bg-primary/5 transition-all duration-300 text-foreground hover:text-foreground"
          id="copyCloneCommand"
        >
          <CodeIcon className="w-5 h-5 mr-2 text-primary" />
          <code class="font-mono text-sm">one-ie/one</code>
        </Button>
        <p
          id="copyMessage"
          class="mt-2 text-sm text-primary opacity-0 transition-opacity duration-200"
        >
          Copied to clipboard!
        </p>
      </Card>
    </div>

    <!-- Secondary Options -->
    <div class="flex flex-wrap gap-4 justify-center mb-12">
      <a
        href={`https://github.com/codespaces/new?hide_repo_select=true&ref=main&repo=${GITHUB_REPO}`}
        class="inline-block"
      >
        <Button
          variant="outline"
          size="lg"
          className="group bg-[#0D1117] hover:bg-[#161B22] border-2 border-[#30363D] hover:border-primary text-white hover:text-white transition-all duration-300"
        >
          <GitHubLogoIcon className="w-5 h-5 mr-2" />
          <span>Open in Codespaces</span>
        </Button>
      </a>

      <a href={GITHUB_URL} class="inline-block">
        <Button
          variant="outline"
          size="lg"
          className="group bg-primary/5 hover:bg-primary/10 text-foreground hover:text-foreground"
        >
          <GitHubLogoIcon className="w-5 h-5 mr-2" />
          <span>View Source</span>
          <div
            class="ml-2 px-2 py-0.5 rounded-full bg-primary/10 text-xs font-medium"
          >
            {stats.stars} ‚≠ê
          </div>
        </Button>
      </a>

      <a href={`${GITHUB_URL}/fork`} class="inline-block">
        <Button
          variant="outline"
          size="lg"
          className="group text-foreground hover:text-foreground"
        >
          <GitHubLogoIcon className="w-5 h-5 mr-2" />
          <span>Fork Project</span>
          <div
            class="ml-2 px-2 py-0.5 rounded-full bg-primary/10 text-xs font-medium"
          >
            {stats.forks}
          </div>
        </Button>
      </a>
    </div>
  </section>

  <!-- System Requirements & Installation -->
  <section class="container mx-auto px-6 py-20 border-t">
    <div class="w-full max-w-[1400px] mx-auto grid md:grid-cols-2 gap-8">
      <Card className="p-8">
        <h2 class="text-2xl font-bold mb-6">System Requirements</h2>
        <ul class="space-y-4">
          {
            SYSTEM_REQUIREMENTS.map((req) => (
              <li class="flex items-start">
                <CheckIcon className="w-5 h-5 mr-2 text-green-500 flex-shrink-0 mt-1" />
                <span>{req}</span>
              </li>
            ))
          }
        </ul>
      </Card>

      <Card className="p-8">
        <h2 class="text-2xl font-bold mb-6">Installation Guide</h2>
        <div class="space-y-6">
          {
            INSTALLATION_STEPS.map((step, index) => (
              <div class="flex items-start">
                <div class="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center mr-4 flex-shrink-0">
                  <span class="font-bold text-primary">{index + 1}</span>
                </div>
                <div>
                  <h3 class="font-semibold mb-1">{step.title}</h3>
                  <p class="text-muted-foreground text-sm">
                    {step.description}
                  </p>
                </div>
              </div>
            ))
          }
        </div>
      </Card>
    </div>
  </section>

  <!-- License Section -->
  <section class="container mx-auto px-6 py-20 border-t">
    <div class="w-full max-w-[1400px] mx-auto">
      <h2 class="text-4xl font-bold mb-10 text-center">ONE Free License</h2>
      <Card className="prose prose-lg max-w-none dark:prose-invert p-8">
        <pre
          class="whitespace-pre-wrap text-sm leading-relaxed opacity-90">{License}</pre>
      </Card>
    </div>
  </section>

  <!-- FAQs -->
  <section class="container mx-auto px-6 py-20 border-t">
    <div class="w-full max-w-[1400px] mx-auto">
      <h2 class="text-4xl font-bold mb-10 text-center">
        Frequently Asked Questions
      </h2>
      <FaqAccordion client:idle faqs={faqs} />
    </div>
  </section>

  <!-- GitHub Call-to-Action -->
  <section class="container mx-auto px-6 pb-20">
    <div class="text-center w-full max-w-[1400px] mx-auto">
      <Alert className="py-6">
        <AlertDescription className="text-lg">
          Join thousands of developers building the future with ONE.
          <a href="https://github.com/one-ie/one" class="inline-block">
            <Button
              variant="link"
              className="ml-3 text-lg text-foreground hover:text-foreground"
            >
              Star on GitHub <GitHubLogoIcon className="ml-2 w-5 h-5" />
            </Button>
          </a>
        </AlertDescription>
      </Alert>
    </div>
  </section>
</Layout>

<style>
  .prose {
    @apply mx-auto;
  }

  .prose pre {
    @apply bg-muted;
  }
</style>

<script>
  // Handle copy functionality
  document.addEventListener("DOMContentLoaded", () => {
    const copyButton = document.getElementById("copyCloneCommand");
    const copyMessage = document.getElementById("copyMessage");

    if (copyButton && copyMessage) {
      copyButton.addEventListener("click", () => {
        navigator.clipboard.writeText("git clone https://github.com/one-ie/one.git");
        copyMessage.classList.remove("opacity-0");
        setTimeout(() => copyMessage.classList.add("opacity-0"), 2000);
      });
    }
  });
</script>
